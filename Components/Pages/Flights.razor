@page "/flights"

@code {
    static List<Flight> flightList = FlightManagement.getFlightList();
    HashSet<String> departures = FlightManagement.fillDepartures(flightList);
    HashSet<String> arrivals = FlightManagement.fillArrivals(flightList);
    HashSet<String> weekdays = new HashSet<string>() { "Any", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday" };

    static SelectedValues selectedValues = new SelectedValues();
    static List<Flight> searchList = new List<Flight>();

    public static void Search()
    {
        searchList.Clear();
        foreach(Flight flight in flightList)
        {
            if ((selectedValues.DepartureAirport == flight.DepartureAirport || selectedValues.DepartureAirport == "Any") && 
                (selectedValues.ArrivalAirport == flight.ArrivalAirport || selectedValues.ArrivalAirport == "Any") && 
                (selectedValues.Weekday == flight.DayOfTheWeek || selectedValues.Weekday == "Any"))
            {
                searchList.Add(flight);
            }
        }
    }

    static SelectedFlight selectedFlight = new SelectedFlight();

    public static void SelectFlight(string flightNumber, string departure, string arrival, string day)
    {
        foreach (Flight flight in flightList)
        {
            if (flight.FlightNumber == flightNumber && flight.DepartureAirport == departure && flight.ArrivalAirport == arrival && flight.DayOfTheWeek == day)
            {
                selectedFlight.FlightNumber = flight.FlightNumber;
                selectedFlight.Airline = flight.Airline;
                selectedFlight.Day = flight.DayOfTheWeek;
                selectedFlight.Time = flight.Time;
                selectedFlight.Cost = flight.Cost;
                selectedFlight.Name = "Name";
                selectedFlight.Citizenship = "Citizenship";
            }
        }
    }

}

<h2 class="section-heading">Flight finder</h2>
<section id="search-section">
    <div class="input-wrapper">
        <label>From:</label>
        <select @bind="selectedValues.DepartureAirport" class="form-select" aria-lagel="Default select example">
            @foreach (string departure in departures)
            {
                <option value="@departure">@departure</option>
            }
        </select>
    </div>

    <div class="input-wrapper">
        <label>To:</label>
        <select @bind="selectedValues.ArrivalAirport" class="form-select">
            @foreach (string arrival in arrivals)
            {
                <option value="@arrival">@arrival</option>
            }
        </select>
    </div>

    <div class="input-wrapper">
        <label>Day:</label>
        <select @bind="selectedValues.Weekday" class="form-select">
            @foreach (string day in weekdays)
            {
                <option value="@day">@day</option>
            }
        </select>
    </div>

    <button class="findButton btn" @onclick="Search">Find Flights</button>
</section>

@if (searchList.Count != 0) {
    <h2 class="section-heading">Flights</h2>
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Flight Number</th>
                <th>Airline</th>
                <th>Departure</th>
                <th>Arrival</th>
                <th>Day</th>
                <th>Time</th>
                <th>Idk</th>
                <th>Cost</th>
            </tr>
        </thead>
        <tbody>
            @foreach (Flight flight in searchList)
            {
                <tr @onclick="@(e => SelectFlight(flight.FlightNumber ,flight.DepartureAirport, flight.ArrivalAirport, flight.DayOfTheWeek))">
                    <td>@flight.FlightNumber</td>
                    <td>@flight.Airline</td>
                    <td>@flight.DepartureAirport</td>
                    <td>@flight.ArrivalAirport</td>
                    <td>@flight.DayOfTheWeek</td>
                    <td>@flight.Time</td>
                    <td>@flight.Idk</td>
                    <td>@flight.Cost</td>
                </tr>
            }
        </tbody>
    </table>
}

<h2 class="section-heading">Reserve</h2>
<section id="reserve-section">
    <div class="input-wrapper">
        <label>Flight number:</label>
        <input type="text" placeholder="Flight number" class="form-control" value="@selectedFlight.FlightNumber" readonly/>
    </div>
    <div class="input-wrapper">
        <label>Airline:</label>
        <input type="text" placeholder="Airline" class="form-control" value="@selectedFlight.Airline" readonly/>
    </div>
    <div class="input-wrapper">
        <label>Day:</label>
        <input type="text" placeholder="Day" class="form-control" value="@selectedFlight.Day" readonly/>
    </div>
    <div class="input-wrapper">
        <label>Time:</label>
        <input type="text" placeholder="Time" class="form-control" value="@selectedFlight.Time" readonly/>
    </div>
    <div class="input-wrapper">
        <label>Cost:</label>
        <input type="text" class="form-control" value="@selectedFlight.Cost" readonly/>
    </div>
    <div class="input-wrapper">
        <label>Name:</label>
        <input type="text" placeholder="Name" class="form-control" />
    </div>
    <div class="input-wrapper">
        <label>Citizenship:</label>
        <input type="text" placeholder="Citizenship" class="form-control" />
    </div>
</section>

